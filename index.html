<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Factory 84</title>
<link rel="stylesheet" href="styles.css" />
</head>
<body>
<video id="bgVideo" autoplay muted loop playsinline>
  <source src="video/background_static.mp4" type="video/mp4" />
</video>
<div id="app">
  <header>
    <div id="runTimer" class="run-timer">Time 00:00:00</div>
    <div id="title">Factory 84</div>
    <div class="wip-tag">WIP build - Win by minting 1000 Godcoins</div>
    <div id="status">Reality is 97% stable.</div>
    <div id="header-actions">
      <button class="btn secondary" id="saveBtn" title="Save to localStorage">Save</button>
      <button class="btn secondary" id="prestigeBtn" title="Timeline Reboot">Timeline Reboot</button>
      <label class="toggle" title="Reduce animations">
        <input type="checkbox" id="reducedMotion" /> Reduced Motion
      </label>
      <label class="toggle" title="Colorblind-friendly palette">
        <input type="checkbox" id="colorblind" /> Colorblind
      </label>
      <label class="toggle" title="UI text size">
        <span>Text</span>
        <select id="textSize">
          <option value="small">Smaller</option>
          <option value="normal" selected>Normal</option>
          <option value="large">Bigger</option>
        </select>
      </label>
      <label class="toggle" title="Screen shake on major events">
        <input type="checkbox" id="shakeToggle" checked /> Shake
      </label>
      <label class="toggle" title="Fireworks on milestones">
        <input type="checkbox" id="fireworksToggle" checked /> Fireworks
      </label>
      <label class="toggle" title="Toggle game audio">
        <input type="checkbox" id="audioToggle" checked /> Sound
      </label>
      <label class="toggle audio-range" title="Sound volume">
        <span>Vol</span>
        <input type="range" id="audioVolume" min="0" max="100" value="60" />
      </label>
    </div>
  </header>
  <div id="resourceBar"></div>
  <div id="statLine"></div>
  <div id="main">
    <section id="leftPanel" class="panel">
      <div id="tabs"></div>
      <div id="tab-contents">
        <div id="tab-buildings" class="tab"></div>
        <div id="tab-research" class="tab"></div>
        <div id="tab-achievements" class="tab"></div>
        <div id="tab-stats" class="tab"></div>
      </div>
    </section>
    <section id="gridPanel" class="panel">
      <div class="card">
        <div>
          <div><strong>Factory Grid</strong> <span class="small" id="gridStats"></span></div>
          <div class="small">The Conveyor Gods demand tribute.</div>
        </div>
        <div class="stack-right">
          <div class="small" id="heatDisplay">Heat: 0%</div>
          <button class="btn secondary" id="buySlotBtn" title="Buy a grid slot">Buy Slot</button>
          <button class="btn secondary" id="blueprintBtn" title="Auto-place selected building" style="display:none;">Blueprint</button>
        </div>
      </div>
      <div id="grid"></div>
      <div id="supportBar" class="support-bar">
        <div class="support-item" id="fanCounter" title="Fans reduce heat without using grid space.">
          <span class="icon">🌀</span>
          <span class="label">Fans</span>
          <span class="value">0</span>
        </div>
        <div class="support-item" id="storageCounter" title="Storage capacity. Right-click for upgrades.">
          <span class="icon">ST</span>
          <span class="label">Storage</span>
          <span class="value">0/0</span>
        </div>
        <div class="support-item" id="burnPurgeItem" title="Toggle Burnt Scrap Purge.">
          <span class="icon">BS</span>
          <span class="label">Purge</span>
          <button class="purge-toggle" id="burnPurgeToggle" type="button">OFF</button>
        </div>
      </div>
      <div id="contractArea" class="contract-mini"></div>
    </section>
    <section id="rightPanel" class="panel">
      <div class="card"><strong>Automation</strong><span class="small">Rules that babysit the grid.</span></div>
      <div id="automationArea" class="automation-panel"></div>
    </section>
  </div>
</div>
<div id="floatingLayer"></div>
<div id="fireworksLayer"></div>
<div id="heatEdge"></div>
<div id="contextMenu">
  <button id="contextToggle" class="btn secondary" type="button">Power Off</button>
  <button id="contextMinerTurbo" class="btn secondary" type="button">Miner Turbo</button>
  <div id="contextMinerInfo" class="small"></div>
  <div id="contextMinerCost" class="small"></div>
  <button id="contextSmelterFurnace" class="btn secondary" type="button">Smelter Furnace</button>
  <div id="contextSmelterInfo" class="small"></div>
  <div id="contextSmelterCost" class="small"></div>
  <button id="contextAshUpgrade" class="btn secondary" type="button">Ash Cleaner Upgrade</button>
  <div id="contextAshInfo" class="small"></div>
  <div id="contextAshCost" class="small"></div>
  <div id="contextAutomation" class="context-automation"></div>
  <button id="contextRemove" class="btn secondary" type="button">Demolish Building</button>
</div>
<div id="fanContextMenu">
  <button id="fanOverclock" class="btn secondary" type="button">Fan Overclock</button>
  <div id="fanOverclockCost" class="small"></div>
  <div id="fanOverclockDesc" class="small">Adds +10% cooling per fan.</div>
  <div id="fanOverclockCount" class="small"></div>
</div>
<div id="storageContextMenu">
  <button id="storageUpgradeBtn" class="btn secondary" type="button">Storage Upgrade</button>
  <div id="storageUpgradeCost" class="small"></div>
  <div id="storageUpgradeDesc" class="small"></div>
  <div id="storageUpgradeLevel" class="small"></div>
</div>
<div id="gameOverOverlay">
  <div id="gameOverCard">
    <div class="gameover-title" id="gameOverTitle">Storage Collapse</div>
    <div class="small" id="gameOverLine1">Your vaults ruptured. The factory drowns in its own output.</div>
    <div class="small" id="gameOverLine2">Expand storage next run. Hoard smarter.</div>
    <div class="gameover-actions">
      <button class="btn" id="gameOverMenu">Main Menu</button>
      <button class="btn secondary" id="gameOverRestart">Restart Run</button>
    </div>
  </div>
</div>
<div id="winOverlay">
  <div id="winCard">
    <div class="gameover-title">Godcoins Ascendant</div>
    <div class="small">1000 Godcoins minted. The portal recognizes your claim.</div>
    <div class="gameover-actions">
      <a class="btn secondary" id="winMenu" href="index.html">Back to Menu</a>
    </div>
  </div>
</div>
<div id="prestigeOverlay">
  <div id="prestigeCard">
    <div><strong>Timeline Reboot</strong></div>
    <div class="small">Pick a Timeline Perk. You cannot unpick destiny.</div>
    <div class="perk-options" id="perkOptions"></div>
  </div>
</div>
<audio id="bgm" src="audio/01.mp3"></audio>
<audio id="aicoreCue" src="audio/02.mp3"></audio>
<script src="js/constants.js"></script>
<script src="js/utils.js"></script>
<script src="js/state.js"></script>
<script src="js/dom.js"></script>
<script src="js/systems.js"></script>
<script src="js/render.js"></script>
<script src="js/main.js"></script>
</body>
</html>

